#+TITLE: PROMICE Level 0 Manual (L0M) log


* 2020-fall / kdm

Fall 2020 - KDM rebuilds (and builds) PROMICE AWS Processing (PAP) toolchain. Documented in [[file:~/projects/GEUS-PROMICE/PROMICE-AWS-processing/README.org]]

+ Copy L0 to L0M: L0/EGP_2016_raw.txt -> L0M/EGP-2016-raw.txt
+ Build L0M/EGP/template.hdr from metadata/EGP_metadata.csv
+ Repeat for other files

** EGP files all have headers that can be re-used and appear the same in EGP_metadata.csv, except 2019-TX

Here are the fields, names, and units used in 2016-raw.txt, and other EGP files:

#+BEGIN_SRC bash :results verbatim :output results 
grep -E "fields =|long_name =|units =" ./EGP/EGP-2016-raw.txt | datamash -t, transpose|cat -n
#+END_SRC

#+RESULTS:
#+begin_example
     1	# fields = dt,# long_name = Time,# units = TS
     2	 n, Record, RN
     3	 minY, Minutes in year, 
     4	 P, Air pressure, hPa
     5	 T, Temperature, C
     6	 T2, Temperature 2, C
     7	 RH, Relative Humidity, %
     8	 WS, Windspeed, m/s
     9	 WD, Wind direction, Deg
    10	 WD_sigma, Wind direction (standard deviation), Deg
    11	 ISWRI, Incoming shortwave radiation, Vx10^-5
    12	 OSWR, Outgoing shortwave radiation, Vx10^-5
    13	 ILWR, Incoming longwave radiation, Vx10^-5
    14	 OLWR, Outgoing longwave radiation, Vx10^-5
    15	 T_rad, Temperature (Radiation Sensor), C
    16	 z_snow, Snow height, m
    17	 z_snow_Q, Snow height (quality), 
    18	 z_s, Surface height, m
    19	 z_S_Q, Surface height (quality), 
    20	 z_i, Ice height, mV
    21	 Ti1, Ice temperature at 1 m depth, C
    22	 Ti2, Ice temperature at 2 m depth, C
    23	 Ti3, Ice temperature at 3 m depth, C
    24	 Ti4, Ice temperature at 4 m depth, C
    25	 Ti5, Ice temperature at 5 m depth, C
    26	 Ti6, Ice temperature at 6 m depth, C
    27	 Ti7, Ice temperature at 7 m depth, C
    28	 Ti10, Ice temperature at 8 m depth, C
    29	 tiltX, Tilt x, Vx10^-2
    30	 tiltY, Tilt y, Vx10^-2
    31	 GPS_t, GPS time, 
    32	 GPS_lat, Latitude, 
    33	 GPS_lon, Longitude, 
    34	 GPS_alt, Altitude, 
    35	 GPS_giodal, Giodal, 
    36	 GPS_GeoUnit, GeoUnit, 
    37	 GPS_q, Quality, 
    38	 GPS_numsat, GPS number of satellites, 
    39	 HDOP, HDOP, 
    40	 T_logger, Temperature in logger, C
    41	 Fan_DC, Fan current, mA
    42	 batt_V_ini, Battery voltage Ini, V
    43	 batt_V, Battery voltage, V
#+end_example

The above matches [[file:~/projects/GEUS-PROMICE/PROMICE-AWS-processing/AWS_data_PROMICE.orig/metadata/EGP_metadata.csv]] - 43 columns, and the data appear to match the units and names.

However, the EGP_metadata.csv says 2019-tx has 38 columns but provides headers for 33 of them.

1) Copy-and-paste the information above into the <<HEREDOC below
2) Delete line numbers after carefully checking with the metadata.csv file
3) Eval this section
4) Copy-and-paste results into the NEAD header, with some minor manual re-formatting

#+BEGIN_SRC bash :results verbatim
cat <<EOF | cut -c7- | datamash -t, transpose
     1	# fields = dt,# long_name = Time,# units = TS
     2	 n, Record, RN
     4	 P, Air pressure, hPa
     5	 T, Temperature, C
     6	 T2, Temperature 2, C
     7	 RH, Relative Humidity, %
     8	 WS, Windspeed, m/s
     9	 WD, Wind direction, Deg
    11	 ISWRI, Incoming shortwave radiation, Vx10^-5
    12	 OSWR, Outgoing shortwave radiation, Vx10^-5
    13	 ILWR, Incoming longwave radiation, Vx10^-5
    14	 OLWR, Outgoing longwave radiation, Vx10^-5
    15	 T_rad, Temperature (Radiation Sensor), C
    16	 z_snow, Snow height, m
    18	 z_s, Surface height, m
    20	 z_i, Ice height, mV
    21	 Ti1, Ice temperature at 1 m depth, C
    22	 Ti2, Ice temperature at 2 m depth, C
    23	 Ti3, Ice temperature at 3 m depth, C
    24	 Ti4, Ice temperature at 4 m depth, C
    25	 Ti5, Ice temperature at 5 m depth, C
    26	 Ti6, Ice temperature at 6 m depth, C
    27	 Ti7, Ice temperature at 7 m depth, C
    28	 Ti10, Ice temperature at 8 m depth, C
    29	 tiltX, Tilt x, Vx10^-2
    30	 tiltY, Tilt y, Vx10^-2
    31	 GPS_t, GPS time, 
    32	 GPS_lat, Latitude, 
    33	 GPS_lon, Longitude, 
    34	 GPS_alt, Altitude, 
    39	 HDOP, HDOP, 
    41	 Fan_DC, Fan current, mA
    43	 batt_V, Battery voltage, V
EOF
#+END_SRC

#+RESULTS:
: 	# fields = dt,	 n,	 P,	 T,	 T2,	 RH,	 WS,	 WD,	 ISWRI,	 OSWR,	 ILWR,	 OLWR,	 T_rad,	 z_snow,	 z_s,	 z_i,	 Ti1,	 Ti2,	 Ti3,	 Ti4,	 Ti5,	 Ti6,	 Ti7,	 Ti10,	 tiltX,	 tiltY,	 GPS_t,	 GPS_lat,	 GPS_lon,	 GPS_alt,	 HDOP,	 Fan_DC,	 batt_V
: # long_name = Time, Record, Air pressure, Temperature, Temperature 2, Relative Humidity, Windspeed, Wind direction, Incoming shortwave radiation, Outgoing shortwave radiation, Incoming longwave radiation, Outgoing longwave radiation, Temperature (Radiation Sensor), Snow height, Surface height, Ice height, Ice temperature at 1 m depth, Ice temperature at 2 m depth, Ice temperature at 3 m depth, Ice temperature at 4 m depth, Ice temperature at 5 m depth, Ice temperature at 6 m depth, Ice temperature at 7 m depth, Ice temperature at 8 m depth, Tilt x, Tilt y, GPS time, Latitude, Longitude, Altitude, HDOP, Fan current, Battery voltage
: # units = TS, RN, hPa, C, C, %, m/s, Deg, Vx10^-5, Vx10^-5, Vx10^-5, Vx10^-5, C, m, m, mV, C, C, C, C, C, C, C, C, Vx10^-2, Vx10^-2, , , , , , mA, V

Then, cut-and-paste that back into the NEAD header



